***************
*** 174,179 ****
      'charts_settings_fields' => array(
        'render element' => 'element',
      ),
    );
  }
  
--- 174,182 ----
      'charts_settings_fields' => array(
        'render element' => 'element',
      ),
+     'charts_chart' => array(
+       'render element' => 'element',
+     ),
    );
  }
  
***************
*** 226,231 ****
    // Convert integer properties to save library modules the hassle.
    charts_cast_element_integer_values($element);
  
    // Include the library specific file and render via their callback.
    if (isset($chart_library_info['file'])) {
      $module_path = drupal_get_path('module', $chart_library_info['module']);
--- 229,237 ----
    // Convert integer properties to save library modules the hassle.
    charts_cast_element_integer_values($element);
  
+   // Generic theme function assuming it will be suitable for most chart types.
+   $element['#theme'] = 'charts_chart';
+ 
    // Include the library specific file and render via their callback.
    if (isset($chart_library_info['file'])) {
      $module_path = drupal_get_path('module', $chart_library_info['module']);
***************
*** 378,384 ****
        charts_cast_element_integer_values($element[$property_name]);
      }
      elseif ($property_name && in_array($property_name, $integer_options)) {
-       $element[$property_name] = is_null($element[$property_name]) ? NULL : (int) $element[$property_name];
      }
    }
  }
--- 384,404 ----
        charts_cast_element_integer_values($element[$property_name]);
      }
      elseif ($property_name && in_array($property_name, $integer_options)) {
+       $element[$property_name] = (is_null($element[$property_name]) || strlen($element[$property_name]) === 0) ? NULL : (int) $element[$property_name];
      }
    }
  }
+ 
+ 
+ /**
+  * Output the chart renderable as a string.
+  */
+ function theme_charts_chart($variables) {
+   $element = $variables['element'];
+ 
+   $attributes = $element['#attributes'];
+   $attributes['id'] = $element['#id'];
+   $attributes['class'][] = 'chart';
+ 
+   return '<div ' . drupal_attributes($attributes) . '>' . (isset($element['#chart']) ? $element['#chart'] : '') . '</div>';
+ }
